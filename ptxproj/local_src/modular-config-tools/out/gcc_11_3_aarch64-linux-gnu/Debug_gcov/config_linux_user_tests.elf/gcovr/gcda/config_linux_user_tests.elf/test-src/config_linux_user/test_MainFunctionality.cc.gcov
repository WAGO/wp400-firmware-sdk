-:    0:Source:test-src/config_linux_user/test_MainFunctionality.cc
-:    1://------------------------------------------------------------------------------
-:    2:// This Source Code Form is subject to the terms of the Mozilla Public
-:    3:// License, v. 2.0. If a copy of the MPL was not distributed with this
-:    4:// file, You can obtain one at http://mozilla.org/MPL/2.0/.
-:    5://
-:    6:// This file is part of project modular-config-tools (PTXdist package modular-config-tools).
-:    7://
-:    8:// Copyright (c) 2017-2022 WAGO GmbH & Co. KG
-:    9://------------------------------------------------------------------------------
-:   10://------------------------------------------------------------------------------
-:   11:///  \file     test_MainFunctionality.cc
-:   12:///
-:   13:///  \brief    Tests for config tool config_linux_user main functionality.
-:   14:///
-:   15:///  \author   PEn: WAGO GmbH & Co. KG
-:   16://------------------------------------------------------------------------------
-:   17:
-:   18://------------------------------------------------------------------------------
-:   19:// include files
-:   20://------------------------------------------------------------------------------
-:   21:#include "ctparts/common_main_defaults.h"
-:   22:#include "ctparts/ctmain.h"
-:   23:#include "params.h"
-:   24:#include "resources.h"
-:   25:#include <gtest/gtest.h>
-:   26:#include "testutil/file_operations.hpp"
-:   27:#include <unistd.h>
-:   28:#include <cstring>
-:   29:#include <fstream>
-:   30:#include <string>
-:   31:
-:   32://------------------------------------------------------------------------------
-:   33:// macros
-:   34://------------------------------------------------------------------------------
-:   35:#define TEST_RANDOM_BYTES_1_SIZE                                            (4U)
-:   36:#define TEST_RANDOM_BYTES_1_VALUE                                           (1U)
-:   37:
-:   38://------------------------------------------------------------------------------
-:   39:// defines; structure, enumeration and type definitions
-:   40://------------------------------------------------------------------------------
-:   41:class MainFunctionalityTest_config_linux_user : public ::testing::Test
-:   42:{
-:   43:  private:
-:   44:    std::string tempDir;
-:   45:    std::string lastErrorFile;
-:   46:    std::string randSource;
-:   47:    std::string testShadow;
-:   48:
-:   49:  protected:
-:   50:    ctutil_Options_t stOptions;
-:   51:    ctutil_Resources_t stResources;
-:   52:    char const szShadowLines[3][128] = { "admin:adminpasswordhash:17000:0:99999:7:::",
-:   53:                                         "root:rootpasswordhash:17000:0:99999:7:::",
-:   54:                                         "nobody:nobodypasswordhash:17000:0:99999:7:::" };
-:   55:
-:   56:  protected:
function _ZN39MainFunctionalityTest_config_linux_userC2Ev called 6 returned 100% blocks executed 100%
6:   57:    MainFunctionalityTest_config_linux_user() {};
call    0 returned 6
call    1 returned 6
call    2 returned 6
call    3 returned 6
call    4 returned 6
6*:   58:    virtual ~MainFunctionalityTest_config_linux_user() {};
------------------
_ZN39MainFunctionalityTest_config_linux_userD0Ev:
function _ZN39MainFunctionalityTest_config_linux_userD0Ev called 0 returned 0% blocks executed 0%
#####:   58:    virtual ~MainFunctionalityTest_config_linux_user() {};
call    0 never executed
call    1 never executed
------------------
_ZN39MainFunctionalityTest_config_linux_userD2Ev:
function _ZN39MainFunctionalityTest_config_linux_userD2Ev called 6 returned 100% blocks executed 100%
6:   58:    virtual ~MainFunctionalityTest_config_linux_user() {};
call    0 returned 6
call    1 returned 6
call    2 returned 6
call    3 returned 6
call    4 returned 6
------------------
function _ZN39MainFunctionalityTest_config_linux_user5SetUpEv called 6 returned 100% blocks executed 54%
6:   59:    virtual void SetUp()
-:   60:    {
6:   61:      statusCode_t status = CTUTIL_SUCCESS;
-:   62:
-:   63:      // Prepare options
6:   64:      memset(&(this->stOptions), 0, sizeof(this->stOptions));
6:   65:      status = ctparts_SetOptionDefaults(NULL, &(this->stOptions));
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
6*:   66:      ASSERT_EQ(CTUTIL_SUCCESS, status);
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 6
branch  4 taken 0 (fallthrough)
branch  5 taken 6
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
call   17 never executed
call   18 returned 6
branch 19 taken 6 (fallthrough)
branch 20 taken 0
call   21 never executed
call   22 never executed
call   23 never executed
-:   67:
-:   68:      // Prepare resources
6:   69:      memset(&(this->stResources), 0, sizeof(this->stResources));
6:   70:      this->stResources.pstSpecificResources = (ctutil_ResourcesSpecific_t *)malloc(sizeof(ctutil_ResourcesSpecific_t));
6:   71:      memset(this->stResources.pstSpecificResources, 0, sizeof(*(this->stResources.pstSpecificResources)));
-:   72:
6:   73:      tempDir = testutil_CreateTempDir("config_linux_user_");
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 6
call    4 returned 6
6:   74:      lastErrorFile = tempDir + "/test_error.txt";
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 6
call    4 returned 6
6:   75:      this->stResources.stCommonResources.szLastErrorFile = lastErrorFile.c_str();
call    0 returned 6
6:   76:      randSource = tempDir + "/test_rand_source.txt";
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 6
call    4 returned 6
6:   77:      this->stResources.pstSpecificResources->szRandomSource1 = randSource.c_str();
call    0 returned 6
6:   78:      this->stResources.pstSpecificResources->szRandomSource2 = "/dev/zero";
6:   79:      testShadow = tempDir + "/test_shadow";
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 6
call    4 returned 6
6:   80:      status = ctutil_PrepareChangeableFile(testShadow.c_str(), &(this->stResources.pstSpecificResources->pShadowFile));
call    0 returned 6
call    1 returned 6
branch  2 taken 6 (fallthrough)
branch  3 taken 0 (throw)
6*:   81:      ASSERT_EQ(CTUTIL_SUCCESS, status);
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 6
branch  4 taken 0 (fallthrough)
branch  5 taken 6
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
call   17 never executed
call   18 returned 6
branch 19 taken 6 (fallthrough)
branch 20 taken 0
call   21 never executed
call   22 never executed
call   23 never executed
-:   82:
-:   83:      // Prepare test files
6:   84:      testutil_CreateFile(this->stResources.stCommonResources.szLastErrorFile);
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
6:   85:      testutil_CreateFile(this->stResources.pstSpecificResources->szRandomSource1);
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
6:   86:      uint8_t const arTestBytes[TEST_RANDOM_BYTES_1_SIZE] = { TEST_RANDOM_BYTES_1_VALUE,
-:   87:                                                              TEST_RANDOM_BYTES_1_VALUE,
-:   88:                                                              TEST_RANDOM_BYTES_1_VALUE,
-:   89:                                                              TEST_RANDOM_BYTES_1_VALUE};
6:   90:      size_t const random1Bytes = sizeof(arTestBytes);
6:   91:      testutil_AppendToFile(this->stResources.pstSpecificResources->szRandomSource1, arTestBytes, random1Bytes);
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
6:   92:      char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
6:   93:      testutil_CreateFile(szShadowFilePath);
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
24:   94:      for(size_t i = 0; i < 3; ++i)
branch  0 taken 18
branch  1 taken 6 (fallthrough)
-:   95:      {
18:   96:        testutil_AppendToFile(szShadowFilePath, (uint8_t const *)this->szShadowLines[i], strlen(this->szShadowLines[i]));
call    0 returned 18
branch  1 taken 18 (fallthrough)
branch  2 taken 0 (throw)
18:   97:        testutil_AppendToFile(szShadowFilePath, (uint8_t const *)"\n", 1U);
call    0 returned 18
branch  1 taken 18 (fallthrough)
branch  2 taken 0 (throw)
-:   98:      }
6:   99:      sync();
call    0 returned 6
-:  100:    }
function _ZN39MainFunctionalityTest_config_linux_user8TearDownEv called 6 returned 100% blocks executed 24%
6:  101:    virtual void TearDown()
-:  102:    {
-:  103:      // Clean test files
6*:  104:      EXPECT_TRUE(testutil_RemoveFile(ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile)));
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 6
branch  4 taken 6 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 6
call    7 returned 6
branch  8 taken 0 (fallthrough)
branch  9 taken 6
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
call   14 never executed
branch 15 never executed
branch 16 never executed
call   17 never executed
branch 18 never executed
branch 19 never executed
call   20 never executed
branch 21 never executed
branch 22 never executed
call   23 never executed
call   24 never executed
call   25 never executed
call   26 returned 6
call   27 never executed
call   28 never executed
call   29 never executed
call   30 never executed
-:  105:      // FIXME: We should clean the temporarily file may be left but if it not exist QEMU will crash when run with Valgrind
-:  106://      (void)testutil_RemoveFile(ctutil_GetChangeableFilePath(this->stResources.pstSpecificResources->pShadowFile));
6*:  107:      EXPECT_TRUE(testutil_RemoveFile(this->stResources.pstSpecificResources->szRandomSource1));
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 6
call    4 returned 6
branch  5 taken 0 (fallthrough)
branch  6 taken 6
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
call   11 never executed
branch 12 never executed
branch 13 never executed
call   14 never executed
branch 15 never executed
branch 16 never executed
call   17 never executed
branch 18 never executed
branch 19 never executed
call   20 never executed
call   21 never executed
call   22 never executed
call   23 returned 6
call   24 never executed
call   25 never executed
call   26 never executed
call   27 never executed
6*:  108:      EXPECT_TRUE(testutil_RemoveFile(this->stResources.stCommonResources.szLastErrorFile));
call    0 returned 6
branch  1 taken 6 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 6
call    4 returned 6
branch  5 taken 0 (fallthrough)
branch  6 taken 6
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
call   11 never executed
branch 12 never executed
branch 13 never executed
call   14 never executed
branch 15 never executed
branch 16 never executed
call   17 never executed
branch 18 never executed
branch 19 never executed
call   20 never executed
call   21 never executed
call   22 never executed
call   23 returned 6
call   24 never executed
call   25 never executed
call   26 never executed
call   27 never executed
6*:  109:      EXPECT_TRUE(testutil_RemoveDir(tempDir.c_str()));
call    0 returned 6
call    1 returned 6
branch  2 taken 6 (fallthrough)
branch  3 taken 0 (throw)
call    4 returned 6
call    5 returned 6
branch  6 taken 0 (fallthrough)
branch  7 taken 6
call    8 never executed
branch  9 never executed
branch 10 never executed
call   11 never executed
call   12 never executed
branch 13 never executed
branch 14 never executed
call   15 never executed
branch 16 never executed
branch 17 never executed
call   18 never executed
branch 19 never executed
branch 20 never executed
call   21 never executed
call   22 never executed
call   23 never executed
call   24 returned 6
call   25 never executed
call   26 never executed
call   27 never executed
call   28 never executed
-:  110:
-:  111:      // Clean resources and options
6:  112:      ctutil_ReleaseFileForChanges(&(this->stResources.pstSpecificResources->pShadowFile));
call    0 returned 6
6:  113:      free(this->stResources.pstSpecificResources);
6:  114:      ctparts_ReleaseSpecificOptions(NULL, &(this->stOptions));
call    0 returned 6
6:  115:    }
-:  116:};
-:  117:
-:  118://------------------------------------------------------------------------------
-:  119:// variables' and constants' definitions
-:  120://------------------------------------------------------------------------------
-:  121:
-:  122://------------------------------------------------------------------------------
-:  123:// test implementation
-:  124://------------------------------------------------------------------------------
4:  125:TEST_F(MainFunctionalityTest_config_linux_user, CheckSetup)
-:  126:{
-:  127:  // Nothing to do here, everything is done in SetUp/TearDown
1:  128:}
------------------
_ZN55MainFunctionalityTest_config_linux_user_CheckSetup_TestC2Ev:
function _ZN55MainFunctionalityTest_config_linux_user_CheckSetup_TestC2Ev called 1 returned 100% blocks executed 100%
1:  125:TEST_F(MainFunctionalityTest_config_linux_user, CheckSetup)
call    0 returned 1
------------------
_ZN55MainFunctionalityTest_config_linux_user_CheckSetup_TestD0Ev:
function _ZN55MainFunctionalityTest_config_linux_user_CheckSetup_TestD0Ev called 1 returned 100% blocks executed 100%
1:  125:TEST_F(MainFunctionalityTest_config_linux_user, CheckSetup)
call    0 returned 1
call    1 returned 1
------------------
_ZN55MainFunctionalityTest_config_linux_user_CheckSetup_TestD2Ev:
function _ZN55MainFunctionalityTest_config_linux_user_CheckSetup_TestD2Ev called 1 returned 100% blocks executed 100%
1:  125:TEST_F(MainFunctionalityTest_config_linux_user, CheckSetup)
call    0 returned 1
------------------
_ZN55MainFunctionalityTest_config_linux_user_CheckSetup_Test8TestBodyEv:
function _ZN55MainFunctionalityTest_config_linux_user_CheckSetup_Test8TestBodyEv called 1 returned 100% blocks executed 100%
1:  125:TEST_F(MainFunctionalityTest_config_linux_user, CheckSetup)
-:  126:{
-:  127:  // Nothing to do here, everything is done in SetUp/TearDown
1:  128:}
------------------
-:  129:
-:  130:
4:  131:TEST_F(MainFunctionalityTest_config_linux_user, ChangePasswordOfUserAdmin)
-:  132:{
1:  133:  char szArg00[] = "test";
1:  134:  char szArg01[] = "plainOptionShouldBeIgnored";
-:  135:  char * const arszArgs[]
-:  136:  {
-:  137:    szArg00,
-:  138:    szArg01,
1:  139:  };
1:  140:  int const argCount = sizeof(arszArgs) / sizeof(char *);
1:  141:  this->stOptions.pstSpecificOptions->szUsername = "admin";
1:  142:  this->stOptions.pstSpecificOptions->szPassword1 = "1234";
1:  143:  this->stOptions.pstSpecificOptions->szPassword2 = "1234";
-:  144:
1:  145:  exitCode_t const result = ctparts_ctMain(argCount, arszArgs, &(this->stOptions), &(this->stResources));
1*:  146:  EXPECT_EQ(CTUTIL_EXIT_SUCCESS, result);
2:  147:  ::std::string lineBuffer;
1:  148:  char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
1*:  149:  EXPECT_STRNE(this->szShadowLines[0], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "admin", lineBuffer));
1*:  150:  EXPECT_STREQ(this->szShadowLines[1], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "root", lineBuffer));
1*:  151:  EXPECT_STREQ(this->szShadowLines[2], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "nobody", lineBuffer));
1:  152:}
------------------
_ZN70MainFunctionalityTest_config_linux_user_ChangePasswordOfUserAdmin_TestC2Ev:
function _ZN70MainFunctionalityTest_config_linux_user_ChangePasswordOfUserAdmin_TestC2Ev called 1 returned 100% blocks executed 100%
1:  131:TEST_F(MainFunctionalityTest_config_linux_user, ChangePasswordOfUserAdmin)
call    0 returned 1
------------------
_ZN70MainFunctionalityTest_config_linux_user_ChangePasswordOfUserAdmin_TestD0Ev:
function _ZN70MainFunctionalityTest_config_linux_user_ChangePasswordOfUserAdmin_TestD0Ev called 1 returned 100% blocks executed 100%
1:  131:TEST_F(MainFunctionalityTest_config_linux_user, ChangePasswordOfUserAdmin)
call    0 returned 1
call    1 returned 1
------------------
_ZN70MainFunctionalityTest_config_linux_user_ChangePasswordOfUserAdmin_TestD2Ev:
function _ZN70MainFunctionalityTest_config_linux_user_ChangePasswordOfUserAdmin_TestD2Ev called 1 returned 100% blocks executed 100%
1:  131:TEST_F(MainFunctionalityTest_config_linux_user, ChangePasswordOfUserAdmin)
call    0 returned 1
------------------
_ZN70MainFunctionalityTest_config_linux_user_ChangePasswordOfUserAdmin_Test8TestBodyEv:
function _ZN70MainFunctionalityTest_config_linux_user_ChangePasswordOfUserAdmin_Test8TestBodyEv called 1 returned 100% blocks executed 27%
1:  131:TEST_F(MainFunctionalityTest_config_linux_user, ChangePasswordOfUserAdmin)
-:  132:{
1:  133:  char szArg00[] = "test";
1:  134:  char szArg01[] = "plainOptionShouldBeIgnored";
-:  135:  char * const arszArgs[]
-:  136:  {
-:  137:    szArg00,
-:  138:    szArg01,
1:  139:  };
1:  140:  int const argCount = sizeof(arszArgs) / sizeof(char *);
1:  141:  this->stOptions.pstSpecificOptions->szUsername = "admin";
1:  142:  this->stOptions.pstSpecificOptions->szPassword1 = "1234";
1:  143:  this->stOptions.pstSpecificOptions->szPassword2 = "1234";
-:  144:
1:  145:  exitCode_t const result = ctparts_ctMain(argCount, arszArgs, &(this->stOptions), &(this->stResources));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  146:  EXPECT_EQ(CTUTIL_EXIT_SUCCESS, result);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 0 (fallthrough)
branch  5 taken 1
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
call   17 never executed
call   18 returned 1
call   19 never executed
call   20 never executed
call   21 never executed
2:  147:  ::std::string lineBuffer;
call    0 returned 1
call    1 returned 1
call    2 never executed
1:  148:  char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  149:  EXPECT_STRNE(this->szShadowLines[0], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "admin", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1*:  150:  EXPECT_STREQ(this->szShadowLines[1], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "root", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1*:  151:  EXPECT_STREQ(this->szShadowLines[2], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "nobody", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1:  152:}
------------------
-:  153:
-:  154:
4:  155:TEST_F(MainFunctionalityTest_config_linux_user, FailChangePasswordOfUserRoot)
-:  156:{
1:  157:  char szArg00[] = "test";
1:  158:  char szArg01[] = "plainOptionShouldBeIgnored";
-:  159:  char * const arszArgs[]
-:  160:  {
-:  161:    szArg00,
-:  162:    szArg01,
1:  163:  };
1:  164:  int const argCount = sizeof(arszArgs) / sizeof(char *);
1:  165:  this->stOptions.pstSpecificOptions->szUsername = "root";
1:  166:  this->stOptions.pstSpecificOptions->szPassword1 = "1234";
1:  167:  this->stOptions.pstSpecificOptions->szPassword2 = "1234";
-:  168:
1:  169:  exitCode_t const result = ctparts_ctMain(argCount, arszArgs, &(this->stOptions), &(this->stResources));
1*:  170:  EXPECT_NE(CTUTIL_EXIT_SUCCESS, result);
2:  171:  ::std::string lineBuffer;
1:  172:  char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
1*:  173:  EXPECT_STREQ(this->szShadowLines[0], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "admin", lineBuffer));
1*:  174:  EXPECT_STREQ(this->szShadowLines[1], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "root", lineBuffer));
1*:  175:  EXPECT_STREQ(this->szShadowLines[2], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "nobody", lineBuffer));
1:  176:}
------------------
_ZN73MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserRoot_TestC2Ev:
function _ZN73MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserRoot_TestC2Ev called 1 returned 100% blocks executed 100%
1:  155:TEST_F(MainFunctionalityTest_config_linux_user, FailChangePasswordOfUserRoot)
call    0 returned 1
------------------
_ZN73MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserRoot_TestD0Ev:
function _ZN73MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserRoot_TestD0Ev called 1 returned 100% blocks executed 100%
1:  155:TEST_F(MainFunctionalityTest_config_linux_user, FailChangePasswordOfUserRoot)
call    0 returned 1
call    1 returned 1
------------------
_ZN73MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserRoot_TestD2Ev:
function _ZN73MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserRoot_TestD2Ev called 1 returned 100% blocks executed 100%
1:  155:TEST_F(MainFunctionalityTest_config_linux_user, FailChangePasswordOfUserRoot)
call    0 returned 1
------------------
_ZN73MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserRoot_Test8TestBodyEv:
function _ZN73MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserRoot_Test8TestBodyEv called 1 returned 100% blocks executed 27%
1:  155:TEST_F(MainFunctionalityTest_config_linux_user, FailChangePasswordOfUserRoot)
-:  156:{
1:  157:  char szArg00[] = "test";
1:  158:  char szArg01[] = "plainOptionShouldBeIgnored";
-:  159:  char * const arszArgs[]
-:  160:  {
-:  161:    szArg00,
-:  162:    szArg01,
1:  163:  };
1:  164:  int const argCount = sizeof(arszArgs) / sizeof(char *);
1:  165:  this->stOptions.pstSpecificOptions->szUsername = "root";
1:  166:  this->stOptions.pstSpecificOptions->szPassword1 = "1234";
1:  167:  this->stOptions.pstSpecificOptions->szPassword2 = "1234";
-:  168:
1:  169:  exitCode_t const result = ctparts_ctMain(argCount, arszArgs, &(this->stOptions), &(this->stResources));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  170:  EXPECT_NE(CTUTIL_EXIT_SUCCESS, result);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 0 (fallthrough)
branch  5 taken 1
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
call   17 never executed
call   18 returned 1
call   19 never executed
call   20 never executed
call   21 never executed
2:  171:  ::std::string lineBuffer;
call    0 returned 1
call    1 returned 1
call    2 never executed
1:  172:  char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  173:  EXPECT_STREQ(this->szShadowLines[0], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "admin", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1*:  174:  EXPECT_STREQ(this->szShadowLines[1], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "root", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1*:  175:  EXPECT_STREQ(this->szShadowLines[2], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "nobody", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1:  176:}
------------------
-:  177:
-:  178:
4:  179:TEST_F(MainFunctionalityTest_config_linux_user, FailChangePasswordOfUserNobody)
-:  180:{
1:  181:  char szArg00[] = "test";
1:  182:  char szArg01[] = "plainOptionShouldBeIgnored";
-:  183:  char * const arszArgs[]
-:  184:  {
-:  185:    szArg00,
-:  186:    szArg01,
1:  187:  };
1:  188:  int const argCount = sizeof(arszArgs) / sizeof(char *);
1:  189:  this->stOptions.pstSpecificOptions->szUsername = "nobody";
1:  190:  this->stOptions.pstSpecificOptions->szPassword1 = "1234";
1:  191:  this->stOptions.pstSpecificOptions->szPassword2 = "1234";
-:  192:
1:  193:  exitCode_t const result = ctparts_ctMain(argCount, arszArgs, &(this->stOptions), &(this->stResources));
1*:  194:  EXPECT_NE(CTUTIL_EXIT_SUCCESS, result);
2:  195:  ::std::string lineBuffer;
1:  196:  char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
1*:  197:  EXPECT_STREQ(this->szShadowLines[0], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "admin", lineBuffer));
1*:  198:  EXPECT_STREQ(this->szShadowLines[1], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "root", lineBuffer));
1*:  199:  EXPECT_STREQ(this->szShadowLines[2], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "nobody", lineBuffer));
1:  200:}
------------------
_ZN75MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserNobody_TestC2Ev:
function _ZN75MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserNobody_TestC2Ev called 1 returned 100% blocks executed 100%
1:  179:TEST_F(MainFunctionalityTest_config_linux_user, FailChangePasswordOfUserNobody)
call    0 returned 1
------------------
_ZN75MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserNobody_TestD0Ev:
function _ZN75MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserNobody_TestD0Ev called 1 returned 100% blocks executed 100%
1:  179:TEST_F(MainFunctionalityTest_config_linux_user, FailChangePasswordOfUserNobody)
call    0 returned 1
call    1 returned 1
------------------
_ZN75MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserNobody_TestD2Ev:
function _ZN75MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserNobody_TestD2Ev called 1 returned 100% blocks executed 100%
1:  179:TEST_F(MainFunctionalityTest_config_linux_user, FailChangePasswordOfUserNobody)
call    0 returned 1
------------------
_ZN75MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserNobody_Test8TestBodyEv:
function _ZN75MainFunctionalityTest_config_linux_user_FailChangePasswordOfUserNobody_Test8TestBodyEv called 1 returned 100% blocks executed 27%
1:  179:TEST_F(MainFunctionalityTest_config_linux_user, FailChangePasswordOfUserNobody)
-:  180:{
1:  181:  char szArg00[] = "test";
1:  182:  char szArg01[] = "plainOptionShouldBeIgnored";
-:  183:  char * const arszArgs[]
-:  184:  {
-:  185:    szArg00,
-:  186:    szArg01,
1:  187:  };
1:  188:  int const argCount = sizeof(arszArgs) / sizeof(char *);
1:  189:  this->stOptions.pstSpecificOptions->szUsername = "nobody";
1:  190:  this->stOptions.pstSpecificOptions->szPassword1 = "1234";
1:  191:  this->stOptions.pstSpecificOptions->szPassword2 = "1234";
-:  192:
1:  193:  exitCode_t const result = ctparts_ctMain(argCount, arszArgs, &(this->stOptions), &(this->stResources));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  194:  EXPECT_NE(CTUTIL_EXIT_SUCCESS, result);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 0 (fallthrough)
branch  5 taken 1
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
call   17 never executed
call   18 returned 1
call   19 never executed
call   20 never executed
call   21 never executed
2:  195:  ::std::string lineBuffer;
call    0 returned 1
call    1 returned 1
call    2 never executed
1:  196:  char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  197:  EXPECT_STREQ(this->szShadowLines[0], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "admin", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1*:  198:  EXPECT_STREQ(this->szShadowLines[1], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "root", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1*:  199:  EXPECT_STREQ(this->szShadowLines[2], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "nobody", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1:  200:}
------------------
-:  201:
-:  202:
4:  203:TEST_F(MainFunctionalityTest_config_linux_user, ChangeHashOfUserAdmin)
-:  204:{
1:  205:  char szArg00[] = "test";
1:  206:  char szArg01[] = "plainOptionShouldBeIgnored";
-:  207:  char * const arszArgs[]
-:  208:  {
-:  209:    szArg00,
-:  210:    szArg01,
1:  211:  };
1:  212:  int const argCount = sizeof(arszArgs) / sizeof(char *);
1:  213:  this->stOptions.pstSpecificOptions->szUsername = "admin";
1:  214:  this->stOptions.pstSpecificOptions->szHash = "fakehash:17000:0:99999";
-:  215:
1:  216:  exitCode_t const result = ctparts_ctMain(argCount, arszArgs, &(this->stOptions), &(this->stResources));
1*:  217:  EXPECT_EQ(CTUTIL_EXIT_SUCCESS, result);
2:  218:  ::std::string lineBuffer;
1:  219:  char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
1*:  220:  EXPECT_STRNE(this->szShadowLines[0], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "admin", lineBuffer));
1*:  221:  EXPECT_STREQ(this->szShadowLines[1], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "root", lineBuffer));
1*:  222:  EXPECT_STREQ(this->szShadowLines[2], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "nobody", lineBuffer));
1:  223:  char const * const szChangedLine = testutil_GetFirstMatchingLineFromFile(szShadowFilePath, this->stOptions.pstSpecificOptions->szHash, lineBuffer);
1*:  224:  EXPECT_NE((void*)NULL, szChangedLine);
1:  225:  if(szChangedLine != NULL)
-:  226:  {
1*:  227:    EXPECT_NE((void*)NULL, strstr(szChangedLine, this->stOptions.pstSpecificOptions->szUsername));
-:  228:  }
1:  229:}
------------------
_ZN66MainFunctionalityTest_config_linux_user_ChangeHashOfUserAdmin_TestC2Ev:
function _ZN66MainFunctionalityTest_config_linux_user_ChangeHashOfUserAdmin_TestC2Ev called 1 returned 100% blocks executed 100%
1:  203:TEST_F(MainFunctionalityTest_config_linux_user, ChangeHashOfUserAdmin)
call    0 returned 1
------------------
_ZN66MainFunctionalityTest_config_linux_user_ChangeHashOfUserAdmin_TestD0Ev:
function _ZN66MainFunctionalityTest_config_linux_user_ChangeHashOfUserAdmin_TestD0Ev called 1 returned 100% blocks executed 100%
1:  203:TEST_F(MainFunctionalityTest_config_linux_user, ChangeHashOfUserAdmin)
call    0 returned 1
call    1 returned 1
------------------
_ZN66MainFunctionalityTest_config_linux_user_ChangeHashOfUserAdmin_TestD2Ev:
function _ZN66MainFunctionalityTest_config_linux_user_ChangeHashOfUserAdmin_TestD2Ev called 1 returned 100% blocks executed 100%
1:  203:TEST_F(MainFunctionalityTest_config_linux_user, ChangeHashOfUserAdmin)
call    0 returned 1
------------------
_ZN66MainFunctionalityTest_config_linux_user_ChangeHashOfUserAdmin_Test8TestBodyEv:
function _ZN66MainFunctionalityTest_config_linux_user_ChangeHashOfUserAdmin_Test8TestBodyEv called 1 returned 100% blocks executed 25%
1:  203:TEST_F(MainFunctionalityTest_config_linux_user, ChangeHashOfUserAdmin)
-:  204:{
1:  205:  char szArg00[] = "test";
1:  206:  char szArg01[] = "plainOptionShouldBeIgnored";
-:  207:  char * const arszArgs[]
-:  208:  {
-:  209:    szArg00,
-:  210:    szArg01,
1:  211:  };
1:  212:  int const argCount = sizeof(arszArgs) / sizeof(char *);
1:  213:  this->stOptions.pstSpecificOptions->szUsername = "admin";
1:  214:  this->stOptions.pstSpecificOptions->szHash = "fakehash:17000:0:99999";
-:  215:
1:  216:  exitCode_t const result = ctparts_ctMain(argCount, arszArgs, &(this->stOptions), &(this->stResources));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  217:  EXPECT_EQ(CTUTIL_EXIT_SUCCESS, result);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 0 (fallthrough)
branch  5 taken 1
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
call   17 never executed
call   18 returned 1
call   19 never executed
call   20 never executed
call   21 never executed
2:  218:  ::std::string lineBuffer;
call    0 returned 1
call    1 returned 1
call    2 never executed
1:  219:  char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  220:  EXPECT_STRNE(this->szShadowLines[0], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "admin", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1*:  221:  EXPECT_STREQ(this->szShadowLines[1], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "root", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1*:  222:  EXPECT_STREQ(this->szShadowLines[2], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "nobody", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1:  223:  char const * const szChangedLine = testutil_GetFirstMatchingLineFromFile(szShadowFilePath, this->stOptions.pstSpecificOptions->szHash, lineBuffer);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  224:  EXPECT_NE((void*)NULL, szChangedLine);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 0 (fallthrough)
branch  5 taken 1
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
call   17 never executed
call   18 returned 1
call   19 never executed
call   20 never executed
call   21 never executed
1:  225:  if(szChangedLine != NULL)
branch  0 taken 1 (fallthrough)
branch  1 taken 0
-:  226:  {
1*:  227:    EXPECT_NE((void*)NULL, strstr(szChangedLine, this->stOptions.pstSpecificOptions->szUsername));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 0 (fallthrough)
branch  5 taken 1
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
call   17 never executed
call   18 returned 1
call   19 never executed
call   20 never executed
call   21 never executed
-:  228:  }
1:  229:}
------------------
-:  230:
-:  231:
4:  232:TEST_F(MainFunctionalityTest_config_linux_user, FailChangeHashOfUserNobody)
-:  233:{
1:  234:  char szArg00[] = "test";
1:  235:  char szArg01[] = "plainOptionShouldBeIgnored";
-:  236:  char * const arszArgs[]
-:  237:  {
-:  238:    szArg00,
-:  239:    szArg01,
1:  240:  };
1:  241:  int const argCount = sizeof(arszArgs) / sizeof(char *);
1:  242:  this->stOptions.pstSpecificOptions->szUsername = "nobody";
1:  243:  this->stOptions.pstSpecificOptions->szHash = "fakehash:17000:0:99999";
-:  244:
1:  245:  exitCode_t const result = ctparts_ctMain(argCount, arszArgs, &(this->stOptions), &(this->stResources));
1*:  246:  EXPECT_NE(CTUTIL_EXIT_SUCCESS, result);
2:  247:  ::std::string lineBuffer;
1:  248:  char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
1*:  249:  EXPECT_STREQ(this->szShadowLines[0], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "admin", lineBuffer));
1*:  250:  EXPECT_STREQ(this->szShadowLines[1], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "root", lineBuffer));
1*:  251:  EXPECT_STREQ(this->szShadowLines[2], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "nobody", lineBuffer));
1:  252:}
------------------
_ZN71MainFunctionalityTest_config_linux_user_FailChangeHashOfUserNobody_TestC2Ev:
function _ZN71MainFunctionalityTest_config_linux_user_FailChangeHashOfUserNobody_TestC2Ev called 1 returned 100% blocks executed 100%
1:  232:TEST_F(MainFunctionalityTest_config_linux_user, FailChangeHashOfUserNobody)
call    0 returned 1
------------------
_ZN71MainFunctionalityTest_config_linux_user_FailChangeHashOfUserNobody_TestD0Ev:
function _ZN71MainFunctionalityTest_config_linux_user_FailChangeHashOfUserNobody_TestD0Ev called 1 returned 100% blocks executed 100%
1:  232:TEST_F(MainFunctionalityTest_config_linux_user, FailChangeHashOfUserNobody)
call    0 returned 1
call    1 returned 1
------------------
_ZN71MainFunctionalityTest_config_linux_user_FailChangeHashOfUserNobody_TestD2Ev:
function _ZN71MainFunctionalityTest_config_linux_user_FailChangeHashOfUserNobody_TestD2Ev called 1 returned 100% blocks executed 100%
1:  232:TEST_F(MainFunctionalityTest_config_linux_user, FailChangeHashOfUserNobody)
call    0 returned 1
------------------
_ZN71MainFunctionalityTest_config_linux_user_FailChangeHashOfUserNobody_Test8TestBodyEv:
function _ZN71MainFunctionalityTest_config_linux_user_FailChangeHashOfUserNobody_Test8TestBodyEv called 1 returned 100% blocks executed 27%
1:  232:TEST_F(MainFunctionalityTest_config_linux_user, FailChangeHashOfUserNobody)
-:  233:{
1:  234:  char szArg00[] = "test";
1:  235:  char szArg01[] = "plainOptionShouldBeIgnored";
-:  236:  char * const arszArgs[]
-:  237:  {
-:  238:    szArg00,
-:  239:    szArg01,
1:  240:  };
1:  241:  int const argCount = sizeof(arszArgs) / sizeof(char *);
1:  242:  this->stOptions.pstSpecificOptions->szUsername = "nobody";
1:  243:  this->stOptions.pstSpecificOptions->szHash = "fakehash:17000:0:99999";
-:  244:
1:  245:  exitCode_t const result = ctparts_ctMain(argCount, arszArgs, &(this->stOptions), &(this->stResources));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  246:  EXPECT_NE(CTUTIL_EXIT_SUCCESS, result);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 0 (fallthrough)
branch  5 taken 1
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
call   17 never executed
call   18 returned 1
call   19 never executed
call   20 never executed
call   21 never executed
2:  247:  ::std::string lineBuffer;
call    0 returned 1
call    1 returned 1
call    2 never executed
1:  248:  char const * szShadowFilePath = ctutil_GetOriginalFilePath(this->stResources.pstSpecificResources->pShadowFile);
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
1*:  249:  EXPECT_STREQ(this->szShadowLines[0], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "admin", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1*:  250:  EXPECT_STREQ(this->szShadowLines[1], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "root", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1*:  251:  EXPECT_STREQ(this->szShadowLines[2], testutil_GetFirstMatchingLineFromFile(szShadowFilePath, "nobody", lineBuffer));
call    0 returned 1
branch  1 taken 1 (fallthrough)
branch  2 taken 0 (throw)
call    3 returned 1
branch  4 taken 1 (fallthrough)
branch  5 taken 0 (throw)
call    6 returned 1
branch  7 taken 0 (fallthrough)
branch  8 taken 1
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
call   20 never executed
call   21 returned 1
call   22 never executed
call   23 never executed
call   24 never executed
1:  252:}
------------------
-:  253:
-:  254:
-:  255://---- End of source file ------------------------------------------------------
-:  256:
